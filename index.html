<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-type" content="text/html" charset="UTF-8">
  <title>小冬同学七夕快乐</title>
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/pageA.css">
  <script src="lib/jquery-3.3.1.min.js"></script>
  <script src="lib/jQueryTransit.js"></script>
  <script src="./js/Swipe.js"></script>
</head>
<style type="text/css">
  .charector {
    width: 151px;
    height: 291px;
    background: url(images/boy.png) 0px -291px no-repeat;
    position: absolute;
    /*设置一个元素的坐标*/
    left: 6%;
    top: 55%;
  }
  .slowWalk {
    /*填入动画样式规则*/
    /*规定@keyframes动画的名称*/
     -webkit-animation-name: person-slow; 
    /*规定动画完成一个周期所花费的秒或毫秒。默认是 0*/
    -webkit-animation-duration: 950ms;
    /*规定动画被播放的次数。默认是 1。 infinite(循环播放)*/
    -webkit-animation-iteration-count: infinite;
    /*动画切换的方式是一帧一帧的改变*/
    -webkit-animation-timing-function: steps(1, start);
    -moz-animation-name: person-slow;
    -moz-animation-duration: 950ms;
    -moz-animation-iteration-count: infinite;
    -moz-animation-timing-function: steps(1, start)
  }
  /*普通慢走*/

  @-webkit-keyframes person-slow {
    0% {
      background-position: -0px -291px;
    }
    25% {
      background-position: -602px -0px;
    }
    50% {
      background-position: -302px -291px;
    }
    75% {
      background-position: -151px -291px;
    }
    100% {
      background-position: -0px -291px;
    }
  }

  @-moz-keyframes person-slow {
    0% {
      background-position: -0px -291px;
    }
    25% {
      background-position: -602px -0px;
    }
    50% {
      background-position: -302px -291px;
    }
    75% {
      background-position: -151px -291px;
    }
    100% {
      background-position: -0px -291px;
    }
  }
</style>

<body>
  <div id="content">
    <ul class="content-wrap">
      <!-- 画面1 -->
      <li>
        <div class="a_background">
          <div class="a_background_top"></div>
          <div class="a_background_middle"></div>
          <div class="a_background_button"></div>
        </div>
      </li>
      <!-- 画面2 -->
      <li>页面2</li>
      <!-- 画面3 -->
      <li>页面3</li>
    </ul>
    <div id="boy" class="charector"></div>
    <div class="button">
      <button>点击开始动画</button>
    </div>
  </div>
  <script type="text/javascript">
    let swipe = Swipe($("#content"));

    //获取数据
    let getValue = function(className) {
      let $elem = $('' + className + '');
      // 走路的路线坐标
      return {
        height: $elem.height(),
        top: $elem.position().top
      };
    };

    // 路的Y轴
    let pathY = function() {
      let data = getValue('.a_background_middle');
      return data.top + data.height / 2;
    }();

    let $boy = $("#boy");
    let boyHeight = $boy.height();

    //修正男孩的正确位置
    //路的中间位置减去小孩的高度，25是一个修正值
    $boy.css({
      top: pathY - boyHeight + 25
    })

    /**
     * 增加精灵动画
     */
    
    $('button').click(()=>{
      $boy.addClass('slowWalk');
    });

    /**
     * 绑定一个点击事件，开始走路
     */
    $("button").click(function() {
      $boy.transition({
        'left': $("#content").width() + 'px',
      },10000,'linear');
    })
  </script>
</body>

</html>