<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-type" content="text/html" charset="UTF-8">
  <title>小冬同学七夕快乐</title>
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/pageA.css">
  <script src="lib/jquery-3.3.1.min.js"></script>
  <script src="lib/jQueryTransit.js"></script>
  <script src="./js/Swipe.js"></script>
</head>
<style type="text/css">
/* 人物暂停 */
.pauseWalk {
    -webkit-animation-play-state: paused;
    -moz-animation-play-state: paused;
}
</style>

<body>
  <div id="content">
    <ul class="content-wrap">
      <!-- 画面1 -->
      <li>
        <div class="a_background">
          <div class="a_background_top"></div>
          <div class="a_background_middle"></div>
          <div class="a_background_button"></div>
        </div>
      </li>
      <!-- 画面2 -->
      <li>页面2</li>
      <!-- 画面3 -->
      <li>页面3</li>
    </ul>
    <div id="boy" class="charector"></div>
    <div class="button">
      <button>点击开始动画</button>
      <button>暂停</button>
    </div>
  </div>
  <script type="text/javascript">
    let swipe = Swipe($("#content"));

    //获取数据
    let getValue = function(className) {
      let $elem = $('' + className + '');
      // 走路的路线坐标
      return {
        height: $elem.height(),
        top: $elem.position().top
      };
    };

    // 路的Y轴
    let pathY = function() {
      let data = getValue('.a_background_middle');
      return data.top + data.height / 2;
    }();

    let $boy = $("#boy");
    let boyHeight = $boy.height();

    //修正男孩的正确位置
    //路的中间位置减去小孩的高度，25是一个修正值
    $boy.css({
      top: pathY - boyHeight + 25
    })

    /**
     * 增加精灵动画
     */
    
    $('button').click(()=>{
      $boy.addClass('slowWalk');
    });

    /**
     * 开始走路
     */
    $("button:first").click(function() {
      $boy.transition({
        'left': $("#content").width() + 'px',
      },10000,'linear');
    });
    
    // 暂停
    $("button:last").click(function(){
      var left = $boy.css('left');
      // 强制做了一个改变目标left的处理
      // 动画是要运行10秒,所以此时动画还是没有结束的
      $boy.css('left',left);
      // 增加暂停的样式
      $boy.addClass('pauseWalk');
    })
  </script>
</body>

</html>